jQuery.expr[":"].focus=function(elem){return elem===document.activeElement&&(elem.type||elem.href);};(function($){$.editable.addInputType("datepicker",{content:function(string,settings,original){var rawDate=$(original).data("raw-date");var datepickerDefaults={altFormat:"yy-mm-dd",};if(settings.datepicker){datepickerDefaults=jQuery.extend({},datepickerDefaults,settings.datepicker);}var parsedDate=$.datepicker.parseDate(datepickerDefaults.altFormat,rawDate,datepickerDefaults);var formattedDate=$.datepicker.formatDate(datepickerDefaults.dateFormat,parsedDate,datepickerDefaults);this.find(".formatted-input").val(formattedDate);this.find(".raw-input").val(rawDate);},submit:function(settings,original){var rawDate=this.find(".raw-input").val();$(original).data("raw-date",rawDate);},element:function(settings,original){var form=$(this);var hidden=$("<input />");hidden.attr("type","hidden");hidden.addClass("raw-input");form.append(hidden);var input=$("<input />");input.attr("autocomplete","off");input.addClass("formatted-input");form.append(input);return hidden;},plugin:function(settings,original){var form=this;var input=form.find(".formatted-input");settings.onblur="nothing";var datepickerDefaults={altField:$(".raw-input",this),altFormat:"yy-mm-dd",showButtonPanel:true,onSelect:function(){form.submit();},onClose:function(){var forceSubmit=false;var event=arguments.callee.caller.caller.arguments[0];if($(event.delegateTarget).hasClass("ui-datepicker-close")){$(this).val("");$(".raw-input",original).val("");forceSubmit=true;}setTimeout(function(){if(forceSubmit){form.submit();}else{if(!input.is(":focus")){original.reset(form);}else{form.submit();}}},250);}};if(settings.datepicker){datepickerDefaults=jQuery.extend({},datepickerDefaults,settings.datepicker);}input.datepicker(datepickerDefaults);}});})(jQuery);